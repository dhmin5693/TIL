# 신뢰성, 확장성, 유지보수성을 가진 애플리케이션

## 데이터 중심 애플리케이션의 주요 개념들

- 데이터베이스 - 추후 데이터를 찾아올 수 있도록 저장
- 캐시 - 읽기 속도 향상을 위해 값비싼 수행 결과 기억
- index - 사용자가 키워드로 데이터를 검색할 수 있도록 함
- stream - 비동기 처리를 위해 다른 프로세스로 메시지 전송
- batch - 대량 데이터 일괄 처리

## 주요 관심사

- 신뢰성
    - 하드웨어, 소프트웨어 결함, 휴먼 에러 등 문제에 봉착해도 시스템이 올바르게 동작해야 한다.
- 확장성
    - 데이터의 총 양, 트래픽, 복잡도가 증가해도 처리할 수 있는 적절한 방법이 있어야 한다.
- 유지보수성
    - 시간이 지나 다양한 사람들이 작업을 할 때 생산적으로 작업할 수 있어야 한다.

## 신뢰성

- `결함`은 잘못될 수 있는 일을 의미
- `탄력성`은 결함을 예측하고 대처할 수 있는 시스템을 의미
- 결함과 장애는 다른 말이다.
    - 결함은 사양에서 벗어난 시스템의 한 요소
    - 장애는 사용자에게 시스템이 정지하여 서비스를 제공하지 못하는 상황

### 하드웨어 결함

- 만 개의 하드디스크는 평균 하루에 한 개가 죽는다.
    - RAID 구성 등으로 장애가 발생하지 않는 설계를 고민해야 한다.
- AWS는 신뢰성보다 유연성, 탄력성을 우선적으로 처리하게끔 설계된 플랫폼

### 소프트웨어 결함

- 시스템적인 오류
    - 잘못된 입력 발생 (리눅스 진영의 2012년 6월 30일 윤초 사태)
    - CPU time, memory, disk space, network 대역처럼 자원을 과하게 사용하는 프로세스
    - 시스템의 속도가 느려져 무반응 혹은 잘못된 응답을 반환하는 서비스
    - 하나의 결함이 다른 결함을 야기하는 연쇄 장애
- 빠르게 해결할 수 있는 방법은 없으나 테스트, 프로세스 격리, 죽은 프로세스 재시작 허용, 시스템 모니터링 등으로 해결에 도움을 줄 수 있음.

### 인적 오류 (Human error)

- 사용자의 실수로 인한 오류
- 대규모 인터넷 서비스의 장애는 대부분이 인적 오류인 것으로 나타남
- 오류를 최소화하는 방법 사용
    - 잘 설계된 추상화, API, 인터페이스 등
    - 프로덕션에 지장이 가지 않는 샌드박스 환경에서 개발
    - 철저한 테스트 (통합, 단위 테스트)
    - 빠르게 롤백할 수 있는 시스템
    - 성능 지표 모니터링으로 대책 마련하기

## 확장성

현재 잘 작동하는 시스템이 미래에도 안정적으로 동작한다는 보장은 없다.

### 부하 기술하기

- 부하는 부하 매개변수(load parameter)라 불리는 몇 개의 숫자로 표현 가능
    - 웹 서버 초당 요청 수
    - DB의 읽기 쓰기 비율
    - active user
    - 캐시 적중률
- 대규모 부하 처리는 상황에 따라 적절하게 처리한다.
    - 사용하는 방식에 따라 트레이드 오프가 발생
    - 장점과 단점을 잘 비교해야 한다.
    - 일반적으로 쓰기보다는 읽는 데에 부하가 많다.

### 성능 기술하기

- 부하 매개변수를 증가시키고 시스템 자원을 유지하면 시스템 성능에 가는 영향은?
- 부하 매개변수가 증가해도 성능이 변하지 않아야 한다면 자원을 얼마나 늘려야 할까?
- 성능을 나타내는 주요 지표
    - 처리량 (일괄 처리 시스템에서 중요)
    - 응답 시간 (온라인 시스템에서 중요)
        - 응답 시간의 평균보다는 백분위 지표를 살펴보는 것이 좋다.
        - 중앙값은 어느 정도인가?
- 큐 대기 지연 방지
    - 소수의 느린 요청으로 인해 다수의 빠른 요청이 지체될 수 있음
    - **선두 차단**

### 부하 대응 접근 방식

- scaling up (용량 확장)
    - vertical scaling
- scaling out (규모 확장)
    - horizontal scaling
    - shared-nothing archtecture
    - 다수의 장비에 부하를 분산하는 기법
- 탄력적인 시스템은 부하 증가 감지 시 컴퓨팅 자원을 자동으로 추가

## 유지보수성

- 소프트웨어 시스템 설계 원칙
    - 운용성: 운영팀이 시스템을 원활하게 운영할 수 있어야 함
    - 단순성: 엔지니어가 쉽게 이해할 수 있는 시스템
        - 커플링, 복잡도, 강한 의존성 등이 SW를 복잡하게 만드는 요소
        - 추상화로 세부 구현을 숨기면 복잡도 제거에 용이
    - 발전성: 추후 시스템 변경이 쉬워야 함
        - 애자일 패턴
        - TDD, refactoring
